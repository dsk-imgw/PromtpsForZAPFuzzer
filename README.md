# LLM Prompts for ZAP (Zed Attack Proxy) Fuzzer

## スキャンの実行

1. ZAP を起動
2. ブラウザやターミナルにプロキシー設定を行い、対象の URL にアクセスして、ZAP に HTTP 通信をキャプチャさせる。
3. 「サイト」ツリーから診断対象の URL を選択し、右クリックで「攻撃」→「Fuzzer の開始」を選択
4. 「Fuzz Locations」ウィンドウで置換する箇所をドラッグして選択する。JSON の値の場合、両端の " も含める（元データの JSON エンコードも必要。Python で json.dumps() などして別途データを用意してください）。
5. 4.を実行すると、右画面の「Fuzz Locations:」の「追加」ボタンが押せるようになるので、押下する。
6. 「Payloads」ウィンドウで「追加」を押下する。
7. 「ペイロードを追加」ウィンドウで、タイプで「ファイル」を選択し、「参照」を押下してペイロード ファイルを選択する。
8. 「Payload Preview:」に表示されるペイロードの内容を確認（とりあえず何も表示されていない状態ではないことを確認）して、「追加」を押下する。
9. 「Payloads」ウィンドウで、⑧で追加したファイルが一覧にあることを確認して、「OK」を押下する。
10. 最後に、「Payloads」ウィンドウ右下の「Start Fuzzer」を押下する。

## 結果の確認とエクスポート

1. メイン ウィンドウの下部「Fuzzer」に進捗状況が表示されるので、「進行状況」が 100% になり、「Error:」の件数が 0 であることを確認する。
2. メイン ウィンドウの下部「Fuzzer」の全行を選択して、右クリックから「Add to Sites Tree & History」を選択する。
3. メイン ウィンドウの下部「履歴」を選択し、②で選択した通信が追加されていることを確認する。そのうえで、全行を選択し、メニューの「エクスポート」→「Save Messages ...」を選択する。
4. ファイル名を指定して、「保存」する。

## その他

- Burp Suite の Intruder でも同じことができるはずです。ただし、Pro 版（有料版）でないと、速度制限や結果保存不可の制約を受けます。

![ZAP02](https://github.com/user-attachments/assets/7d77a85a-39be-4888-acd3-74914c1d65c7)
